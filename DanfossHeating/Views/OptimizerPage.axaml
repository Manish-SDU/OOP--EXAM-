<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:DanfossHeating.ViewModels"
             xmlns:converters="using:DanfossHeating.Converters"
             xmlns:lvc="using:LiveChartsCore.SkiaSharpView.Avalonia"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="DanfossHeating.Views.OptimizerPage"
             x:DataType="vm:OptimizerViewModel">

    <UserControl.Resources>
        <converters:BoolToColorConverter x:Key="BoolToColorConverter" 
                                        TrueValue="White" 
                                        FalseValue="Black"/>
        <converters:EnumToStringConverter x:Key="EnumToStringConverter"/>
    </UserControl.Resources>
    
    <!-- Background based on theme (light/dark) -->
    <UserControl.Background>
        <SolidColorBrush Color="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#1E1E1E:#F0F0F0'}" />
    </UserControl.Background>
      <Grid>        <!-- Optimizer Image -->
        <Image 
            Source="/Assets/Danffy/optimizer.png"
            Width="300"
            Height="330"
            Margin="20,300,0,20"
            VerticalAlignment="Bottom"
            HorizontalAlignment="Left"
            ZIndex="99" />

        <!-- Header Panel with Accent Background -->
        <Border Height="70" 
                VerticalAlignment="Top"
                Background="#D40000"
                BoxShadow="0 2 10 0 #40000000"
                ZIndex="10">
            <Grid>
                <!-- User Profile (Left) -->
                <StackPanel Orientation="Horizontal" 
                            VerticalAlignment="Center" 
                            HorizontalAlignment="Left"
                            Margin="20,0,0,0">
                    <!-- Profile Circle -->
                    <Border Width="50" Height="50" Background="#D40000" CornerRadius="25"
                            BorderThickness="2" BorderBrush="#FFFFFF"
                            BoxShadow="0 2 8 0 #40000000">
                        <TextBlock Text="{Binding UserInitial}" 
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center"
                                   FontSize="24" 
                                   FontWeight="Bold" 
                                   Foreground="White"/>
                    </Border>
                    
                    <!-- User Name -->
                    <TextBlock Text="{Binding UserName}" 
                               Foreground="White"
                               FontWeight="SemiBold"
                               FontSize="20"
                               Margin="10,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Theme Toggle (Right) -->
                <Button Command="{Binding ToggleThemeCommand}"
                        Width="50" Height="50" CornerRadius="25"
                        HorizontalAlignment="Right" 
                        VerticalAlignment="Center"
                        Margin="0,0,20,0"
                        Padding="6"
                        Background="#20FFFFFF"
                        BorderBrush="#40FFFFFF"
                        BorderThickness="1">
                    <Panel>
                        <!-- Light Theme Icon (Sun) -->
                        <PathIcon Data="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41.39.39 1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41.39.39 1.03.39 1.41 0l1.06-1.06z"
                               IsVisible="{Binding IsDarkTheme}" 
                               Foreground="#FFFF00"
                               Width="30" Height="30"/>
                        
                        <!-- Dark Theme Icon (Moon) -->
                        <PathIcon Data="M9.37 5.51c-.18.64-.27 1.31-.27 1.99 0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27C17.45 17.19 14.93 19 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"
                               IsVisible="{Binding !IsDarkTheme}" 
                               Foreground="#004080"
                               Width="30" Height="30"/>
                    </Panel>
                </Button>
            </Grid>
        </Border>
        
        <!-- Main Content Area -->
        <Grid Margin="0,70,0,0">
            <!-- Navigation Menu -->
            <Border Width="240"
                    Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#252525:#F8F8F8'}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Stretch"
                    BorderBrush="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#40FFFFFF:#20000000'}"
                    BorderThickness="0,0,1,0">
                <StackPanel Margin="0,15,0,0" Spacing="2">
                    <!-- Home -->
                    <Button Command="{Binding NavigateToHomeCommand}"
                            Height="54"
                            Background="Transparent"
                            BorderThickness="0" 
                            Padding="15,5" 
                            Margin="8,3"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Left"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" 
                                     Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                     Width="22" Height="22"/>
                            <TextBlock Text="Home" 
                                      FontSize="16"
                                      FontWeight="Normal" 
                                      Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                      VerticalAlignment="Center"
                                      Margin="15,0,0,0"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- Optimizer - Current Page -->
                    <Button Height="54" 
                            Background="#D40000"
                            BorderThickness="0" 
                            Padding="15,5" 
                            Margin="8,3"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Left"
                            CornerRadius="8">
                        <Button.Effect>
                            <DropShadowEffect BlurRadius="10" Color="#40D40000" OffsetX="0" OffsetY="2"/>
                        </Button.Effect>
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z" 
                                     Foreground="White" 
                                     Width="22" Height="22"/>
                            <TextBlock Text="Optimizer" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Foreground="White" 
                                      VerticalAlignment="Center"                                      Margin="15,0,0,0"/>
                        </StackPanel>
                    </Button>
                      <!-- Additional Insights Title -->
                    <TextBlock Text="Additional Insights"
                            Margin="8,15,8,10"
                            HorizontalAlignment="Center"
                            FontSize="16"
                            FontWeight="SemiBold"
                            Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}"/><StackPanel Orientation="Horizontal" 
                              Margin="8,0,8,8" 
                              Spacing="4" 
                              HorizontalAlignment="Center">                        <!-- Electricity Prices Button -->
                        <Button Command="{Binding ShowElectricityPricesCommand}"                                Height="45"
                                Width="45"
                                Background="Transparent"
                                BorderThickness="2"
                                BorderBrush="#D40000"
                                Padding="0"
                                HorizontalAlignment="Center"
                                HorizontalContentAlignment="Center"
                                CornerRadius="8"
                                ToolTip.Tip="Electricity Prices"
                                IsVisible="{Binding SelectedScenario, Converter={StaticResource EnumToStringConverter}, ConverterParameter='Scenario 2'}">                            <TextBlock Text="⚡"
                                     FontSize="18"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"/>                            <Button.Styles>                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#B80000"/>
                                </Style>
                                <Style Selector="Button /template/ ContentPresenter">
                                    <Setter Property="Background" Value="{Binding ShowingElectricityPrices, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#D40000:Transparent'}"/>
                                </Style>
                            </Button.Styles>
                        </Button>                        <!-- Production Costs Button -->
                        <Button Command="{Binding ShowProductionCostsCommand}"                                Height="45"
                                Width="45"
                                Background="Transparent"
                                BorderThickness="2"
                                BorderBrush="#D40000"
                                Padding="0"
                                HorizontalAlignment="Center"
                                HorizontalContentAlignment="Center"
                                CornerRadius="8"
                                ToolTip.Tip="Production Costs">                            <TextBlock Text="💰"
                                     FontSize="18"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"/>                            <Button.Styles>                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#B80000"/>
                                </Style>
                                <Style Selector="Button /template/ ContentPresenter">
                                    <Setter Property="Background" Value="{Binding ShowingProductionCosts, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#D40000:Transparent'}"/>
                                </Style>
                            </Button.Styles>
                        </Button>                        <!-- CO2 Emissions Button -->
                        <Button Command="{Binding ShowCO2EmissionsCommand}"                                Height="45"
                                Width="45"
                                Background="Transparent"
                                BorderThickness="2"
                                BorderBrush="#D40000"
                                Padding="0"
                                HorizontalAlignment="Center"
                                HorizontalContentAlignment="Center"
                                CornerRadius="8"
                                ToolTip.Tip="CO2 Emissions">                            <TextBlock Text="🌱"
                                     FontSize="18"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"/>                            <Button.Styles>
                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#B80000"/>
                                </Style>
                                <Style Selector="Button /template/ ContentPresenter">
                                    <Setter Property="Background" Value="{Binding ShowingCO2Emissions, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#D40000:Transparent'}"/>
                                </Style>
                            </Button.Styles>
                        </Button>
                    </StackPanel>
                    
                    <!-- Machinery -->
                    <Button Command="{Binding NavigateToMachineryCommand}"
                            Height="54" 
                            Background="Transparent"
                            BorderThickness="0" 
                            Padding="15,5" 
                            Margin="8,3"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Left"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" 
                                     Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                     Width="22" Height="22"/>
                            <TextBlock Text="Machinery" 
                                      FontSize="16" 
                                      FontWeight="Normal" 
                                      Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                      VerticalAlignment="Center"
                                      Margin="15,0,0,0"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- About Us -->
                    <Button Command="{Binding NavigateToAboutUsCommand}"
                            Height="54" 
                            Background="Transparent"
                            BorderThickness="0" 
                            Padding="15,5" 
                            Margin="8,3"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Left"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z" 
                                     Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                     Width="22" Height="22"/>
                            <TextBlock Text="About Us" 
                                      FontSize="16" 
                                      FontWeight="Normal" 
                                      Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0:#333333'}" 
                                      VerticalAlignment="Center"
                                      Margin="15,0,0,0"/>                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
            
            <!-- Content Area -->
            <Border Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#252525:#FFFFFF'}"
                    BorderBrush="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#40FFFFFF:#20000000'}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Margin="260,20,20,20"
                    BoxShadow="0 2 10 0 #30000000"
                    Padding="25">
                <Grid RowDefinitions="Auto,Auto,Auto,*">
                    <!-- Header Section with Toggle Button -->
                    <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,20">
                        <!-- Header Text (Centered) -->
                        <StackPanel Grid.Column="0" Grid.ColumnSpan="2" Spacing="5" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="Optimizer" 
                                       FontSize="28"
                                       FontWeight="Bold" 
                                       Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,0"/>
                            
                            <TextBlock Text="Optimize your heat production based on cost or CO2 emissions" 
                                       FontSize="15"
                                       TextWrapping="Wrap"
                                       Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                       HorizontalAlignment="Center"
                                       TextAlignment="Center"
                                       Margin="0,5,0,0"
                                       Opacity="0.7"/>
                        </StackPanel>
                        
                        <!-- Toggle Controls Visibility Button -->
                        <Button Grid.Column="1" 
                                Command="{Binding ToggleControlsVisibilityCommand}"
                                Width="36" Height="36"
                                Margin="15,0,0,0"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Right"
                                Background="Transparent"
                                BorderThickness="0"
                                ToolTip.Tip="{Binding ToggleButtonTooltip}">
                            <PathIcon Data="{Binding IsControlPanelVisible, Converter={StaticResource EnumToStringConverter}, ConverterParameter='true:M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z:M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z'}"
                                     Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                     Width="22" Height="22"/>
                        </Button>
                    </Grid>
                    
                    <!-- Collapsible Controls Notification -->
                    <Border Grid.Row="1" 
                            Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#303545:#EFF8FF'}"
                            BorderBrush="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#4050A0:#90C0FF'}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15,10"
                            Margin="0,0,0,15"
                            IsVisible="{Binding ShowControlsNotification}"
                            BoxShadow="0 1 6 0 #15000000">
                        <Grid ColumnDefinitions="Auto,*,Auto">
                            <!-- Info Icon -->
                            <TextBlock Grid.Column="0" 
                                       Text="💡" 
                                       FontSize="18"
                                       Margin="0,0,10,0"
                                       VerticalAlignment="Center"/>
                            
                            <!-- Notification Message -->
                            <TextBlock Grid.Column="1" 
                                       Text="Tip: Use the arrow button ⬇️ in the top right to collapse this control panel and see the full chart. Click ⬆️ later to show controls again." 
                                       TextWrapping="Wrap"
                                       VerticalAlignment="Center"
                                       FontSize="13"
                                       Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"/>
                            
                            <!-- Dismiss Button -->
                            <Button Grid.Column="2" 
                                    Command="{Binding DismissControlsNotificationCommand}"
                                    Content="✕"
                                    FontSize="14"
                                    Padding="8,2"
                                    Margin="10,0,0,0"
                                    Background="Transparent"
                                    Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>
                    
                    <!-- Controls Section (Collapsible) -->
                    <Border Grid.Row="2" 
                            Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#303030:#F5F5F5'}"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,20"
                            IsVisible="{Binding IsControlPanelVisible}"
                            BoxShadow="0 2 8 1 #18000000">
                        <!-- Replace Grid with a responsive layout -->
                        <Grid RowDefinitions="Auto,Auto"> 
                            
                            <!-- Zoom Toggle and Export Button -->
                            <StackPanel Grid.Row="0" 
                                      Orientation="Vertical"
                                      HorizontalAlignment="Right"
                                      VerticalAlignment="Top"
                                      Margin="0,0,10,10"
                                      Spacing="10">
                                <ToggleSwitch IsChecked="{Binding IsZooming}"
                                             OnContent="Zoom On"
                                             OffContent="Zoom Off"/>
                                
                                <Button Command="{Binding ExportChartCommand}"
                                       Content="Export Graph"
                                       Height="32"
                                       FontSize="14"
                                       Padding="15,0"
                                       Background="#D40000"
                                       Foreground="White"
                                       HorizontalContentAlignment="Center"
                                       VerticalContentAlignment="Center"
                                       CornerRadius="4">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="#B80000"/>
                                        </Style>
                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="#900000"/>
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </StackPanel>

                            <!-- Control Options using WrapPanel for responsiveness -->
                            <WrapPanel Grid.Row="0" 
                                       Orientation="Horizontal"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,15">
                                <!-- Optimization Criteria Section -->
                                <Border Padding="15,10"
                                        Margin="5,5,10,5"
                                        CornerRadius="4"
                                        MinWidth="200"
                                        MaxWidth="300"
                                        Height="90"
                                        Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#3A3A3A:#EFEFEF'}">
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="🎯 Optimize By"
                                                   FontSize="15"
                                                   FontWeight="SemiBold" 
                                                   Margin="0,0,0,10"
                                                   Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"/>
                                        
                                        <ComboBox HorizontalAlignment="Stretch"
                                                  MinWidth="160"
                                                  Padding="12,8"
                                                  FontSize="14"
                                                  CornerRadius="4"
                                                  ItemsSource="{Binding OptimizationOptions}"
                                                  SelectedIndex="{Binding OptimizationCriteriaIndex, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Season Selection Section -->
                                <Border Padding="15,10"
                                        Margin="5"
                                        CornerRadius="4"
                                        MinWidth="200"
                                        MaxWidth="300"
                                        Height="90"
                                        Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#3A3A3A:#EFEFEF'}">
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="📅 Season"
                                                   FontSize="15"
                                                   FontWeight="SemiBold" 
                                                   Margin="0,0,0,10"
                                                   Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"/>
                                        
                                        <StackPanel Orientation="Horizontal" Spacing="20" VerticalAlignment="Center" MinHeight="36">
                                            <RadioButton Content="☀️ Summer"
                                                        FontFamily="Segoe UI Emoji, Segoe UI Symbol, Segoe UI, Arial"
                                                        Classes="ModernRadioButton"
                                                        GroupName="SeasonGroup"
                                                        FontSize="14"
                                                        IsChecked="{Binding SelectedSeason, Converter={StaticResource EnumToStringConverter}, ConverterParameter='Summer', Mode=TwoWay}"
                                                        Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                                        VerticalAlignment="Center"/>
                                            
                                            <RadioButton Content="❄️ Winter"
                                                        Classes="ModernRadioButton"
                                                        GroupName="SeasonGroup"
                                                        FontSize="14"
                                                        IsChecked="{Binding SelectedSeason, Converter={StaticResource EnumToStringConverter}, ConverterParameter='Winter', Mode=TwoWay}"
                                                        Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                                        VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Scenario Selection Section -->
                                <Border Padding="15,10"
                                        Margin="10,5,5,5"
                                        CornerRadius="4"
                                        MinWidth="200"
                                        MaxWidth="300"
                                        Height="90"
                                        Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#3A3A3A:#EFEFEF'}">
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="📊 Scenario"
                                                   FontSize="15"
                                                   FontWeight="SemiBold" 
                                                   Margin="0,0,0,10"
                                                   Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"/>
                                        
                                        <StackPanel Orientation="Horizontal" Spacing="20" VerticalAlignment="Center" MinHeight="36">
                                            <RadioButton Content="Scenario 1"
                                                        Classes="ModernRadioButton"
                                                        GroupName="ScenarioGroup"
                                                        FontSize="14"
                                                        IsChecked="{Binding SelectedScenario, Converter={StaticResource EnumToStringConverter}, ConverterParameter='Scenario 1', Mode=TwoWay}"
                                                        Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                                        VerticalAlignment="Center"/>
                                            
                                            <RadioButton Content="Scenario 2"
                                                        Classes="ModernRadioButton"
                                                        GroupName="ScenarioGroup"
                                                        FontSize="14"
                                                        IsChecked="{Binding SelectedScenario, Converter={StaticResource EnumToStringConverter}, ConverterParameter='Scenario 2', Mode=TwoWay}"
                                                        Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"
                                                        VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                              <!-- Action Buttons -->                            <StackPanel Grid.Row="1" 
                                      Orientation="Horizontal" 
                                      HorizontalAlignment="Center" 
                                      Spacing="15"
                                      Margin="0,1,0,0">
                                
                                <Button Command="{Binding OptimizeCommand}"
                                        Content="Optimize"
                                        Height="48"
                                        FontSize="22"
                                        Padding="20,10"
                                        Width="450"
                                        Background="#D40000"
                                        Foreground="White"
                                        CornerRadius="5"
                                        HorizontalContentAlignment="Center">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="#B80000"/>
                                        </Style>
                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="#900000"/>
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Chart Area with Enhanced Visuals -->
                    <Grid Grid.Row="3" RowDefinitions="Auto,*">
                        <!-- Zoom Instructions -->
                        <TextBlock Text="Use mouse wheel to zoom, drag to pan ✨"
                                  IsVisible="{Binding IsZooming}"
                                  Opacity="0.7"
                                  FontSize="12"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Top"
                                  ZIndex="10"
                                  Margin="0,0,5,5"
                                  Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}}"/>
                        
                        <!-- Professional Interactive Chart -->
                        <lvc:CartesianChart Grid.Row="1"
                                            x:Name="chart"
                                            Series="{Binding Series}"
                                            XAxes="{Binding XAxes}"
                                            YAxes="{Binding YAxes}"
                                            Title="{Binding Title}"
                                            ZoomMode="{Binding IsZooming, Converter={StaticResource EnumToStringConverter}, ConverterParameter='true:X:None'}"
                                            TooltipPosition="Top"
                                            TooltipBackgroundPaint="{Binding TooltipBackgroundPaint}"
                                            TooltipTextPaint="{Binding TooltipTextPaint}"
                                            LegendPosition="Top"
                                            LegendTextPaint="{Binding LegendTextPaint}"
                                            LegendBackgroundPaint="{Binding LegendBackgroundPaint}"
                                            DrawMarginFrame="{Binding IsDarkTheme, Converter={StaticResource EnumToStringConverter}, ConverterParameter='true:#454545:#FFFFFF'}"
                                            AnimationsSpeed="00:00:00.500"
                                            EasingFunction="{Binding EasingFunction}"
                                            Margin="0,0,0,15"/>

                        <!-- Export Success Notification -->
                        <Border Grid.Row="0" Grid.RowSpan="2"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Bottom"
                                Margin="0,0,0,30"
                                Padding="15,10"
                                Background="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#4CAF50:#DFF0D8'}"
                                BorderBrush="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#388E3C:#D6E9C6'}"
                                BorderThickness="1"
                                CornerRadius="6"
                                BoxShadow="0 2 8 0 #20000000"
                                IsVisible="{Binding ShowExportSuccessNotification}"
                                ZIndex="20">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="✅" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding ExportSuccessMessage}"
                                           Foreground="{Binding IsDarkTheme, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#FFFFFF:#3C763D'}"
                                           FontSize="14"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>
